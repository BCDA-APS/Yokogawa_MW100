<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<title>mw100Docs</title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">mw100 module Documentation</h1>

<P><a href="mw100ReleaseNotes.html">Release Notes</a>

This module is for Asyn-based support for the Yokogawa MW100 Digital
Acquisition Unit.  This device uses a network interface to
communicate, and has a modular design to allow the mixing of DAC, ADC,
relay, TTL, and other modules.  It is also an industrial device
primarily used for monitoring, so its design is not optimized for high
performance operation.  The system is actually quite complex, as it
can: read modbus channels over both serial and the network, perform
calculations on the measurements if the math option is present, set
alarms, do logging, etc.  The purpose of this support is to turn into
PVs the simpler values that can either be read or set; there is no
attempt made to utilize the full capability of the device from EPICS,
although this support does not preclude using it externally.

The support uses the base C-level support from Asyn, using the
asynFloat64, asynInt32, and asynOctetRead device types.

I assume that the support works for all modules, but this has been
tested only with the following: MX110-UNV-M10, MX115-D05-H10,
MX120-VAO-M08, and MX125-MKC-M10.

<h2>Channel descriptions</h2>

The MW100 can handle up to 60 measurement channels, referred to as
channels 001-060.  If the math option is also purchased, then the
supported channels are also 300 computation channels (A001-A300) and
300 communication input channels (C001-C300); there are more channels,
but they are not supported.

The module bus can have up to 6 modules on it.  The maximum number
of I/O channels for the MW100 is 60 (referred to as channels 001-060),
with a maximum of 10 channels per modules.  Each module has a
dedicated slice of the 60 channels, with the first module owning
001-010, the second owning 011-020, etc.  The first module is the one
closest to the main module.


<h2>Setting up the unit</h2>

Due to the complexity of the MW100, the configuration of the unit
currently needs to be done through its web interface.  This includes
not only service configuration, but also channel configuration.  The
way the unit works is that there are modes of operation.  Any
configuration needs to be done while in the "Settings" mode, while all
data acquisition is done in the "Meaurements" mode.  The mode can be
toggle from EPICS or through the native web browser.  So to do
configuration changes, make sure the unit is in Settings mode or it
will not save any changes.

Upon getting the unit, get it on your network, as described in the
manual.


Plug your modules into the module bus, realizing that each module
location to the left of the main module oper



<h2>Operation</h2>

Once the unit is configured and running on the network, The EPICS
support in this module will work for reading data while in Measurement
mode.  When the unit is switched to Settings mode, it will still poll
for values, but the values will not change.  

The changing of mode should be done from EPICS so that it knows to
query the settings values when the unit is switched from Settings mode
to Measurement mode.  The settings values for instance sets the scale
factor for the measurement values (which are read as integers).

The default way the measurements are done is that there are two
records that trigger reading all of the values on the device, one for
input values (such as ADC and TTL) and another for output values (such
as DAC and relay).  By default, both records use a time value in their
SCAN fields to periodically poll values and put them into a cache, and
the record for these values are set to <b>I/O Intr</b> which allow them to
be updated by an interrupt call.  If a measurement record is decoupled
from the master poll rates by setting their SCAN field to a time
value, the data associated with a record will be retrieved with all
the associated information put into the cache, and the new value will
be returned; however, the associated status, unit, and alarm records
for the measurement will return cached values only.  This means that
to do read an independent channel is to read the measurement value,
then forward link to all the associated records to grab the cached
values from that read.

If the math option was bought, there are also calculations and
communication inputs to be read by the pollers. The calculations
(which need to be defined through the web interface right now) allow
the transformation of measurements with the communication input values
and predefined constants.  The first 60 calculation channels allow for
a long calculation (string length of 120 characters), while the last
240 channels allow for short calculations (8 or 10 characters,
depending on firmware version).

When an error happpens, the error string is displayed, split into
three 40-character string records.  The error can be cleared, which
also clears it from the units LED display.

<h2>EPICS Databases</h2>

There are 

<h2>MEDM display files</h2>


<P>

<dl>
<dt>mw100.adl<br>
<dd>This is the main medm ADL file for the mw100 support.

</dl>



<address> 
    <a href="http://www.aps.anl.gov/About/People/Contact/?name=Dohn__Arms">
    Dohn Arms</a><br>
    Advanced Photon Source
</address>
</body>
</html>
